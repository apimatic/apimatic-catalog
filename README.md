# Portal Catalog Repository

This repository is designed to manage all the static portals generated against build files using the APIMatic DocsGen flow. Each portal is contained in its own directory, with separate subdirectories for build files and it's generated content. The repository uses GitHub Actions to automate the process of building and deploying the portals to Cloudflare.

## Repository Structure

The repository is organized as follows:

```
.
├── Portal1/
│   ├── BuildFiles/
│   └── Portal/
├── Portal2/
│   ├── BuildFiles/
│   └── Portal/
├── Portal3/
│   ├── BuildFiles/
│   └── Portal/
└── .github/
    └── workflows/
        └── build-and-deploy.yml
```

- **`PortalName/BuildFiles/`**: Contains the build file(s) needed to generate the portal.
- **`PortalName/Portal/`**: Contains the generated static website files generated by the onPrem APIMatic Transformer API.
- **`.github/workflows/`**: Contains the GitHub Actions workflow for automating the build and deployment process.

## How to Add a New Portal

To add a new portal to this repository, follow these steps:

1. **Create a New Directory:**
   - In the root directory of the repository, create a new directory named after your portal. For example, if your portal is named "MyPortal," create a folder named `MyPortal/`.

2. **Add Your Build Files:**
   - Inside the new directory, create a subdirectory called `BuildFiles/`.
   - Add your build file(s) to the `BuildFiles/` directory. This file should contain all the necessary configurations for generating your portal. Do **NOT** zip the build file(s)

3. **Push Your Changes:**
   - Once you have added your build file(s), commit and push your changes to the repository:
     ```bash
     git add MyPortal/
     git commit -m "Add build files for MyPortal"
     git push origin main
     ```

## GitHub Actions Workflow

This repository uses a GitHub Actions workflow to automatically generate and deploy portals whenever changes are made to the build files. The workflow performs the following steps:

1. **Trigger:** The workflow is triggered whenever a push request is made to any file within the `BuildFiles/` directories.
2. **Checkout Code:** The latest version of the repository is checked out. 
3. **Process Build File:** The build file is zipped and sent to [APIMatic’s API endpoint](https://docs.apimatic.io/platform-api/#/http/api-endpoints/docs-portal-management/generate-on-prem-portal-via-build-input): `Generate On-Prem Portal Via Build Input`, which processes the build file(s) and generates the portal.
4. **Store Output:** The generated portal files are saved in the `PortalName/Portal/` directory.
5. **Deploy to Cloudflare:** The contents of the `PortalName/Portal/` directory are deployed to Cloudflare hosting.

## Deployment to Cloudflare

The workflow automatically deploys the generated portal to Cloudflare. If you need to manually deploy or troubleshoot, you can use the following steps:

1. **Manual Deployment:**
   - Ensure your generated files are in the `PortalName/Portal/` directory.
   - Use the Cloudflare CLI or API to deploy the files:
     ```bash
     cloudflare deploy PortalName/Portal/
     ```

2. **Monitoring Deployments:**
   - You can monitor the deployment status via the GitHub Actions tab in your repository or by checking your Cloudflare dashboard.

## Published Portals
Here is the list of all the portals that are currently published to cloudflare from this `apimatic-catalog` repository:<http://hackernews-apimatic-testrun.pages.dev>
<http://test-apimatic-testrun.pages.dev>

{
	"info": {
		"_postman_id": "83986800-9ea4-4878-bc11-deca71444286",
		"name": "Crosskey Open Banking API Example",
		"description": "This postman collection contains example requests for PSD2 APIs version 3.1.6",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "--SETUP--",
			"item": [
				{
					"name": "Add JS library",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.globals.set(\"jsrsasign-js\", responseBody);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "https://archive.crosskey.io/documentation/postman/jsrsasign-unofficial-hotfix-all-min.js",
							"protocol": "https",
							"host": [
								"archive",
								"crosskey",
								"io"
							],
							"path": [
								"documentation",
								"postman",
								"jsrsasign-unofficial-hotfix-all-min.js"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "AISP",
			"item": [
				{
					"name": "(1) /account-access-consents",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"",
									"// Setting parameters for 'Get authentication URL' method, so one can be used for both payments and accounts",
									"pm.globals.set(\"consentType\", \"account\");",
									"pm.globals.set(\"scope\", \"accounts openid\");",
									"",
									"pm.globals.set(\"consentId\", jsonData.Data.ConsentId);",
									"pm.globals.set(\"transactionFromDateTime\", jsonData.Data.TransactionFromDateTime);",
									"pm.globals.set(\"transactionToDateTime\", jsonData.Data.TransactionToDateTime);"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"description": "Needs to be inserted",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{bearerToken}}",
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman."
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"Data\":{\r\n\t  \"Permissions\":[\r\n\t    \"ReadAccountsBasic\",\r\n\t    \"ReadAccountsDetail\",\r\n\t    \"ReadBalances\",\r\n\t    \"ReadTransactionsBasic\",\r\n\t    \"ReadTransactionsCredits\",\r\n\t    \"ReadTransactionsDebits\",\r\n\t    \"ReadTransactionsDetail\"\r\n\t  ]\r\n  },\r\n  \"Risk\":{}\r\n}"
						},
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/aisp/account-access-consents",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"aisp",
								"account-access-consents"
							]
						},
						"description": "# The API allows the AISP to ask an ASPSP to create a new account-access-consent resource."
					},
					"response": []
				},
				{
					"name": "(2) /account-access-consents/{ConsentId}",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"description": "Needs to be created",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{bearerToken}}",
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman."
							}
						],
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/aisp/account-access-consents/{{consentId}}",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"aisp",
								"account-access-consents",
								"{{consentId}}"
							]
						},
						"description": "# An AISP may optionally retrieve an account-access-consent resource that they have created to check its status."
					},
					"response": []
				},
				{
					"name": "(3) /account-access-consents/{ConsentId}",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"description": "Needs to be created",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{bearerToken}}",
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman."
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/aisp/account-access-consents/{{consentId}}",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"aisp",
								"account-access-consents",
								"{{consentId}}"
							]
						},
						"description": "# If the PSU revokes consent to data access with the AISP, the AISP must delete the account-access-consent resource with the ASPSP before confirming consent revocation with the PSU."
					},
					"response": []
				},
				{
					"name": "(4) /accounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"pm.globals.set(\"accountId\", jsonData.Data.Account[0].AccountId);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"description": "Needs to be created",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{authorizedBearerToken}}"
							}
						],
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/aisp/accounts",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"aisp",
								"accounts"
							]
						},
						"description": "# An AISP will be given the full list of accounts (the AccountId(s)) that the PSU has authorised the AISP to access."
					},
					"response": []
				},
				{
					"name": "(5) /accounts/{AccountId}/balances",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman.",
								"description": "Needs to be created",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{authorizedBearerToken}}"
							}
						],
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/aisp/accounts/{{accountId}}/balances",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"aisp",
								"accounts",
								"{{accountId}}",
								"balances"
							]
						},
						"description": "# An AISP may retrieve the account balance information resource for a specific AccountId (which is retrieved in the call to GET /accounts)."
					},
					"response": []
				},
				{
					"name": "(6) /accounts/{AccountId}/transactions",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman.",
								"description": "Needs to be created",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{authorizedBearerToken}}"
							}
						],
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/aisp/accounts/{{accountId}}/transactions",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"aisp",
								"accounts",
								"{{accountId}}",
								"transactions"
							]
						},
						"description": "# An AISP may retrieve the transaction resource for a specific AccountId (which is retrieved in the call to GET /accounts)."
					},
					"response": []
				}
			]
		},
		{
			"name": "CBPII",
			"item": [
				{
					"name": "(1) /funds-confirmation-consents",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"",
									"// Setting parameters for 'Get authentication URL' method, so one can be used for both payments and accounts",
									"pm.globals.set(\"consentType\", \"fundsconfirmation\");",
									"pm.globals.set(\"scope\", \"fundsconfirmations openid\");",
									"",
									"pm.globals.set(\"consentId\", jsonData.Data.ConsentId);",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"description": "Needs to be inserted",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{bearerToken}}",
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman."
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n   \"Data\":{\r\n      \"ExpirationDateTime\":null,\r\n      \"DebtorAccount\":{\r\n         \"SchemeName\":\"UK.OBIE.IBAN\",\r\n         \"Identification\":\"EU1112345624979725\",\r\n         \"Name\":\"John Doe\",\r\n         \"SecondaryIdentification\":null\r\n      }\r\n   }\r\n}"
						},
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/cbpii/funds-confirmation-consents",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"cbpii",
								"funds-confirmation-consents"
							]
						},
						"description": "# The API allows the CBPII to ask an ASPSP to create a new funds-confirmation-consent resource."
					},
					"response": []
				},
				{
					"name": "(2) /funds-confirmation-consents/{ConsentId}",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"description": "Needs to be created",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{bearerToken}}",
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman."
							}
						],
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/cbpii/funds-confirmation-consents/{{consentId}}",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"cbpii",
								"funds-confirmation-consents",
								"{{consentId}}"
							]
						},
						"description": "# A CBPII may optionally retrieve a funds-confirmation-consent resource that they have created to check its status."
					},
					"response": []
				},
				{
					"name": "(3) /funds-confirmation-consents/{ConsentId}",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"description": "Needs to be created",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{bearerToken}}",
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman."
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/cbpii/funds-confirmation-consents/{{consentId}}",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"cbpii",
								"funds-confirmation-consents",
								"{{consentId}}"
							]
						},
						"description": "# If the PSU revokes consent to confirm funds with the CBPII, the CBPII must delete the funds-confirmation-consent resource."
					},
					"response": []
				},
				{
					"name": "(4) /funds-confirmations",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);\r",
									"pm.globals.set(\"fundsConfirmationId\", jsonData.Data.FundsConfirmationId);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							},
							{
								"key": "x-fapi-customer-last-logged-time",
								"type": "text",
								"value": "Sun, 10 Sep 2017 19:43:31 UTC"
							},
							{
								"key": "x-fapi-customer-ip-address",
								"type": "text",
								"value": "127.0.0.1"
							},
							{
								"description": "Generate new for each request for tracability",
								"key": "x-fapi-interaction-id",
								"type": "text",
								"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
							},
							{
								"key": "x-api-key",
								"type": "text",
								"value": "{{x-api-key}}"
							},
							{
								"description": "Needs to be created",
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{authorizedBearerToken}}",
								"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman."
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n   \"Data\":{\r\n      \"ConsentId\":\"{{consentId}}\",\r\n      \"Reference\":\"248eaeb80d984d19be2f097da1075fc9\",\r\n      \"InstructedAmount\":{\r\n         \"Amount\":\"10.0\",\r\n         \"Currency\":\"EUR\"\r\n      }\r\n   }\r\n}"
						},
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/cbpii/funds-confirmations",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v3.1.6",
								"cbpii",
								"funds-confirmations"
							]
						},
						"description": "# If the CBPII would like to confirm funds with the ASPSP, it should create a new funds-confirmation resource, and check the funds available flag in the response."
					},
					"response": []
				}
			]
		},
		{
			"name": "PISP",
			"item": [
				{
					"name": "domestic",
					"item": [
						{
							"name": "(1) /domestic-payment-consents",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"consentId\", jsonData.Data.ConsentId);\r",
											"\r",
											"\r",
											"// Setting parameters for 'Get authentication URL' method, so one can be used for both payments and accounts\r",
											"pm.globals.set(\"consentType\", \"payment\");\r",
											"pm.globals.set(\"scope\", \"payments openid\");\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 1; // -1 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"request.data = request.data.replace(\"{{randomNumber}}\", pm.globals.get(\"randomNumber\"));",
											"",
											"var sHeader = JSON.stringify(header);",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "1f0e68db-3730-45d1-a90f-8fcbea9bf880"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"key": "x-idempotency-key",
										"value": "{{randomUUID}}",
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n        \"Initiation\": {\n            \"InstructionIdentification\": \"{{randomNumber}}\",\n            \"EndToEndIdentification\": \"FRESCO.21302.GFX.20\",\n            \"LocalInstrument\": \"SE.Bankgiro\",\n            \"InstructedAmount\": {\n                \"Amount\": \"2.00\",\n                \"Currency\": \"SEK\"\n            },\n            \"CreditorAccount\": {\n                \"SchemeName\": \"SE.BGNR\",\n                \"Identification\": \"54586961\",\n                \"Name\": \"Jane Roe\"\n            },\n            \"CreditorPostalAddress\": {\n            \t\"Country\": \"SE\"\n            }\n        }\n    },\n    \"Risk\": {}\n}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-payment-consents",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-payment-consents"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to create a new domestic-payment-consent resource."
							},
							"response": []
						},
						{
							"name": "(2) /domestic-payment-consents/{ConsentId}",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"",
											"// Due to eventual changes in debtor account when authorizing payment, ",
											"pm.globals.set(\"domesticPaymentInitiation\", responseBody);"
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC",
										"type": "text"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"value": "127.0.0.1",
										"type": "text"
									},
									{
										"key": "x-fapi-interaction-id",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342",
										"description": "Generate new for each request for tracability",
										"type": "text"
									},
									{
										"key": "x-api-key",
										"value": "{{x-api-key}}",
										"type": "text"
									},
									{
										"key": "Authorization",
										"value": "Bearer {{bearerToken}}",
										"description": "Needs to be inserted",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-payment-consents/{{consentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-payment-consents",
										"{{consentId}}"
									]
								},
								"description": "# A PISP can optionally retrieve a payment consent resource that they have created to check its status."
							},
							"response": []
						},
						{
							"name": "(3) /domestic-payment-consents/{ConsentId}/funds-confirmation",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-payment-consents/{{consentId}}/funds-confirmation",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-payment-consents",
										"{{consentId}}",
										"funds-confirmation"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to confirm funds on a domestic-payment-consent resource."
							},
							"response": []
						},
						{
							"name": "(4) /domestic-payments",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 1; // -1 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"var sHeader = JSON.stringify(header);",
											"",
											"// Request data must be exactly the same as what the JWS is based on",
											"request.data = pm.globals.get(\"domesticPaymentInitiation\");",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"domesticPaymentId\", jsonData.Data.DomesticPaymentId);\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "d9148ef7-b4e8-4958-8f09-64c283364e37"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{authorizedBearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"key": "x-idempotency-key",
										"value": "{{randomUUID}}",
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{{domesticPaymentInitiation}}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-payments",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-payments"
									]
								},
								"description": "# Once the domestic-payment-consent has been authorised by the PSU, the PISP can proceed to submitting the domestic-payment for processing."
							},
							"response": []
						},
						{
							"name": "(5) /domestic-payments/{DomesticPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-payments/{{domesticPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-payments",
										"{{domesticPaymentId}}"
									]
								},
								"description": "# A PISP can retrieve the domestic-payment to check its status."
							},
							"response": []
						}
					],
					"description": "The domestic payments are a little bit more restricted as to which financial institution actually delivers them, check documentation for availability.",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					]
				},
				{
					"name": "domestic scheduled payment",
					"item": [
						{
							"name": "(1) /domestic-scheduled-payment-consents",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"consentId\", jsonData.Data.ConsentId);\r",
											"\r",
											"\r",
											"// Setting parameters for 'Get authentication URL' method, so one can be used for both payments and accounts\r",
											"pm.globals.set(\"consentType\", \"payment\");\r",
											"pm.globals.set(\"scope\", \"payments openid\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 1; // -1 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"request.data = request.data.replace(\"{{randomNumber}}\", pm.globals.get(\"randomNumber\"));",
											"",
											"var requestedExecutionDateTime = new Date();",
											"requestedExecutionDateTime.setDate(requestedExecutionDateTime.getDate() + 1);",
											"pm.globals.set(\"requestedExecutionIsoDateTime\", requestedExecutionDateTime.toISOString())",
											"request.data = request.data.replace(\"{{requestedExecutionIsoDateTime}}\", pm.globals.get(\"requestedExecutionIsoDateTime\"));",
											"",
											"var sHeader = JSON.stringify(header);",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "1f0e68db-3730-45d1-a90f-8fcbea9bf880"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n    \t\"Permission\": \"Create\",\n        \"Initiation\": {\n            \"InstructionIdentification\": \"{{randomNumber}}\",\n            \"EndToEndIdentification\": \"FRESCO.21302.GFX.20\",\n            \"RequestedExecutionDateTime\": \"{{requestedExecutionIsoDateTime}}\",\n            \"LocalInstrument\": \"SE.Bankgiro\",\n            \"InstructedAmount\": {\n                \"Amount\": \"2.00\",\n                \"Currency\": \"SEK\"\n            },\n            \"CreditorAccount\": {\n                \"SchemeName\": \"SE.BGNR\",\n                \"Identification\": \"59535849\",\n                \"Name\": \"Jane Roe\"\n            },\n            \"CreditorPostalAddress\": {\n            \t\"Country\": \"SE\"\n            }\n        }\n    },\n    \"Risk\": {}\n}\n"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-scheduled-payment-consents",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-scheduled-payment-consents"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to create a new domestic-scheduled-payment-consent resource."
							},
							"response": []
						},
						{
							"name": "(2) /domestic-scheduled-payment-consents/{ConsentId}",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);",
											"",
											"pm.globals.set(\"domesticScheduledPaymentInitiation\", JSON.stringify(jsonData.Data.Initiation));"
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-scheduled-payment-consents/{{consentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-scheduled-payment-consents",
										"{{consentId}}"
									]
								},
								"description": "# A PISP can optionally retrieve a payment consent resource that they have created to check its status."
							},
							"response": []
						},
						{
							"name": "(4) /domestic-scheduled-payments",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 10; // -1 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"var sHeader = JSON.stringify(header);",
											"",
											"request.data = request.data.replace(\"{{consentId}}\", pm.globals.get(\"consentId\"));",
											"request.data = request.data.replace(\"{{domesticScheduledPaymentInitiation}}\", pm.globals.get(\"domesticScheduledPaymentInitiation\"));",
											"",
											"// Request data must be exactly the same as what the JWS is based on",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"domesticScheduledPaymentId\", jsonData.Data.DomesticScheduledPaymentId);\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{authorizedBearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n    \t\"ConsentId\": \"{{consentId}}\",\n        \"Initiation\": {{domesticScheduledPaymentInitiation}}\n    },\n    \"Risk\": {}\n}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-scheduled-payments",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-scheduled-payments"
									]
								},
								"description": "# Once the domestic-scheduled-payment-consent has been authorised by the PSU, the PISP can proceed to submitting the domestic-scheduled-payment for processing."
							},
							"response": []
						},
						{
							"name": "(5) /domestic-scheduled-payments/{DomesticScheduledPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-scheduled-payments/{{domesticScheduledPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-scheduled-payments",
										"{{domesticScheduledPaymentId}}"
									]
								},
								"description": "# A PISP can retrieve the domestic-scheduled-payment to check its status."
							},
							"response": []
						},
						{
							"name": "(6) /domestic-scheduled-payments/{DomesticScheduledPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-scheduled-payments/{{domesticScheduledPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-scheduled-payments",
										"{{domesticScheduledPaymentId}}"
									]
								},
								"description": "# A PISP can delete a future payment"
							},
							"response": []
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					]
				},
				{
					"name": "domestic standing order",
					"item": [
						{
							"name": "(1) /domestic-standing-order-consents",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"consentId\", jsonData.Data.ConsentId);\r",
											"\r",
											"\r",
											"// Setting parameters for 'Get authentication URL' method, so one can be used for both payments and accounts\r",
											"pm.globals.set(\"consentType\", \"payment\");\r",
											"pm.globals.set(\"scope\", \"payments openid\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 10; // -10 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"var firstPaymentDateTime = new Date();",
											"firstPaymentDateTime.setDate(firstPaymentDateTime.getDate() + 1);",
											"pm.globals.set(\"firstPaymentIsoDateTime\", firstPaymentDateTime.toISOString())",
											"request.data = request.data.replace(\"{{firstPaymentIsoDateTime}}\", pm.globals.get(\"firstPaymentIsoDateTime\"));",
											"",
											"var sHeader = JSON.stringify(header);",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "1f0e68db-3730-45d1-a90f-8fcbea9bf880"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n    \t\"Permission\": \"Create\",\n        \"Initiation\": {\n            \"Frequency\": \"EVERY_MONTH\",\n            \"FirstPaymentDateTime\": \"{{firstPaymentIsoDateTime}}\",\n            \"FirstPaymentAmount\": {\n                \"Amount\": \"2.00\",\n                \"Currency\": \"SEK\"\n            },\n            \"CreditorAccount\": {\n                \"SchemeName\": \"SE.BGNR\",\n                \"Identification\": \"99026003950\",\n                \"Name\": \"Jane Roe\"\n            }\n        }\n    },\n    \"Risk\": {}\n}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-standing-order-consents",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-standing-order-consents"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to create a new domestic-standing-order-consent resource."
							},
							"response": []
						},
						{
							"name": "(2) /domestic-standing-order-consents/{ConsentId}",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);",
											"",
											"pm.globals.set(\"domesticStandingOrderPaymentInitiation\", JSON.stringify(jsonData.Data.Initiation));"
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-standing-order-consents/{{consentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-standing-order-consents",
										"{{consentId}}"
									]
								},
								"description": "# A PISP can optionally retrieve a payment consent resource that they have created to check its status."
							},
							"response": []
						},
						{
							"name": "(4) /domestic-standing-orders",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 10; // -10 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"var sHeader = JSON.stringify(header);",
											"",
											"request.data = request.data.replace(\"{{consentId}}\", pm.globals.get(\"consentId\"));",
											"request.data = request.data.replace(\"{{domesticStandingOrderPaymentInitiation}}\", pm.globals.get(\"domesticStandingOrderPaymentInitiation\"));",
											"// Request data must be exactly the same as what the JWS is based on",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"domesticStandingOrderPaymentId\", jsonData.Data.DomesticStandingOrderId);\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{authorizedBearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n    \t\"ConsentId\": \"{{consentId}}\",\n        \"Initiation\": {{domesticStandingOrderPaymentInitiation}}\n    },\n    \"Risk\": {}\n}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-standing-orders",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-standing-orders"
									]
								},
								"description": "# Once the domestic-standing-order-consent has been authorised by the PSU, the PISP can proceed to submitting the domestic-standing-order for processing."
							},
							"response": []
						},
						{
							"name": "(5) /domestic-standing-orders/{DomesticStandingOrderPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-standing-orders/{{domesticStandingOrderPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-standing-orders",
										"{{domesticStandingOrderPaymentId}}"
									]
								},
								"description": "# A PISP can retrieve the domestic-standing-order to check its status."
							},
							"response": []
						},
						{
							"name": "(6) /domestic-standing-orders/{DomesticStandingOrderPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/domestic-standing-orders/{{domesticStandingOrderPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"domestic-standing-orders",
										"{{domesticStandingOrderPaymentId}}"
									]
								},
								"description": "# A PISP can delete a future payment"
							},
							"response": []
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					]
				},
				{
					"name": "international",
					"item": [
						{
							"name": "(1) /international-payment-consents",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 1; // -1 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"request.data = request.data.replace(\"{{randomNumber}}\", pm.globals.get(\"randomNumber\"));",
											"",
											"var sHeader = JSON.stringify(header);",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"consentId\", jsonData.Data.ConsentId);\r",
											"\r",
											"\r",
											"// Setting parameters for 'Get authentication URL' method, so one can be used for both payments and accounts\r",
											"pm.globals.set(\"consentType\", \"payment\");\r",
											"pm.globals.set(\"scope\", \"payments openid\");"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "1f0e68db-3730-45d1-a90f-8fcbea9bf880"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n        \"Initiation\": {\n            \"InstructionIdentification\": \"{{randomNumber}}\",\n            \"EndToEndIdentification\": \"FRESCO.21302.GFX.20\",\n            \"CurrencyOfTransfer\": \"EUR\",\n            \"InstructedAmount\": {\n                \"Amount\": \"2.00\",\n                \"Currency\": \"EUR\"\n            },\n            \"CreditorAccount\": {\n                \"SchemeName\": \"UK.OBIE.IBAN\",\n                \"Identification\": \"FI4966010005485495\",\n                \"Name\": \"Jane Roe\"\n            }\n        }\n    },\n    \"Risk\": {}\n}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-payment-consents",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-payment-consents"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to create a new international-payment-consent resource."
							},
							"response": []
						},
						{
							"name": "(2) /international-payment-consents/{ConsentId}",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"",
											"// Due to eventual changes in debtor account when authorizing payment, ",
											"pm.globals.set(\"internationalPaymentInitiation\", responseBody);"
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC",
										"type": "text"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"value": "127.0.0.1",
										"type": "text"
									},
									{
										"key": "x-fapi-interaction-id",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342",
										"description": "Generate new for each request for tracability",
										"type": "text"
									},
									{
										"key": "x-api-key",
										"value": "{{x-api-key}}",
										"type": "text"
									},
									{
										"key": "Authorization",
										"value": "Bearer {{bearerToken}}",
										"description": "Needs to be inserted",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-payment-consents/{{consentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-payment-consents",
										"{{consentId}}"
									]
								},
								"description": "# A PISP can optionally retrieve a payment consent resource that they have created to check its status."
							},
							"response": []
						},
						{
							"name": "(3) /international-payment-consents/{ConsentId}/funds-confirmation",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC",
										"type": "text"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"value": "127.0.0.1",
										"type": "text"
									},
									{
										"key": "x-fapi-interaction-id",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342",
										"description": "Generate new for each request for tracability",
										"type": "text"
									},
									{
										"key": "x-api-key",
										"value": "{{x-api-key}}",
										"type": "text"
									},
									{
										"key": "Authorization",
										"value": "Bearer {{bearerToken}}",
										"description": "Needs to be inserted",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-payment-consents/{{consentId}}/funds-confirmation",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-payment-consents",
										"{{consentId}}",
										"funds-confirmation"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to confirm funds on an international-payment-consent resource."
							},
							"response": []
						},
						{
							"name": "(4) /international-payments",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 1; // -1 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"var sHeader = JSON.stringify(header);",
											"",
											"// Request data must be exactly the same as what the JWS is based on",
											"console.log(\"The initiation: \" + pm.globals.get(\"internationalPaymentInitiation\"))",
											"request.data = pm.globals.get(\"internationalPaymentInitiation\");",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"internationalPaymentId\", jsonData.Data.InternationalPaymentId);\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{authorizedBearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{{internationalPaymentInitiation}}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-payments",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-payments"
									]
								},
								"description": "# Once the international-payment-consent has been authorised by the PSU, the PISP can proceed to submit the international-payment for processing."
							},
							"response": []
						},
						{
							"name": "(5) /international-payments/{InternationalPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-payments/{{internationalPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-payments",
										"{{internationalPaymentId}}"
									]
								},
								"description": "# A PISP can retrieve the international-payment to check its status."
							},
							"response": []
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					]
				},
				{
					"name": "international scheduled payment",
					"item": [
						{
							"name": "(1) /international-scheduled-payment-consents",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"consentId\", jsonData.Data.ConsentId);\r",
											"\r",
											"\r",
											"// Setting parameters for 'Get authentication URL' method, so one can be used for both payments and accounts\r",
											"pm.globals.set(\"consentType\", \"payment\");\r",
											"pm.globals.set(\"scope\", \"payments openid\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 1; // -1 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"request.data = request.data.replace(\"{{randomNumber}}\", pm.globals.get(\"randomNumber\"));",
											"",
											"var requestedExecutionDateTime = new Date();",
											"requestedExecutionDateTime.setDate(requestedExecutionDateTime.getDate() + 1);",
											"pm.globals.set(\"requestedExecutionIsoDateTime\", requestedExecutionDateTime.toISOString())",
											"request.data = request.data.replace(\"{{requestedExecutionIsoDateTime}}\", pm.globals.get(\"requestedExecutionIsoDateTime\"));",
											"",
											"var sHeader = JSON.stringify(header);",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "1f0e68db-3730-45d1-a90f-8fcbea9bf880"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n    \t\"Permission\": \"Create\",\n        \"Initiation\": {\n            \"InstructionIdentification\": \"{{randomNumber}}\",\n            \"EndToEndIdentification\": \"FRESCO.21302.GFX.20\",\n            \"RequestedExecutionDateTime\": \"{{requestedExecutionIsoDateTime}}\",\n            \"CurrencyOfTransfer\": \"EUR\",\n            \"InstructedAmount\": {\n                \"Amount\": \"2.00\",\n                \"Currency\": \"EUR\"\n            },\n            \"CreditorAccount\": {\n                \"SchemeName\": \"UK.OBIE.IBAN\",\n                \"Identification\": \"FI4966010005485495\",\n                \"Name\": \"Jane Roe\"\n            }\n        }\n    },\n    \"Risk\": {}\n}\n"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-scheduled-payment-consents",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-scheduled-payment-consents"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to create a new international-scheduled-payment-consent resource."
							},
							"response": []
						},
						{
							"name": "(2) /international-scheduled-payment-consents/{ConsentId}",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);",
											"",
											"pm.globals.set(\"internationalScheduledPaymentInitiation\", JSON.stringify(jsonData.Data.Initiation));"
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-scheduled-payment-consents/{{consentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-scheduled-payment-consents",
										"{{consentId}}"
									]
								},
								"description": "# A PISP can optionally retrieve a payment consent resource that they have created to check its status."
							},
							"response": []
						},
						{
							"name": "(3) /international-scheduled-payment-consents/{ConsentId}/funds-confirmation",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-scheduled-payment-consents/{{consentId}}/funds-confirmation",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-scheduled-payment-consents",
										"{{consentId}}",
										"funds-confirmation"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to confirm funds on an international-scheduled-payment-consent resource, where the payment is for immediate debit."
							},
							"response": []
						},
						{
							"name": "(4) /international-scheduled-payments",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 1; // -1 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"var sHeader = JSON.stringify(header);",
											"",
											"request.data = request.data.replace(\"{{consentId}}\", pm.globals.get(\"consentId\"));",
											"request.data = request.data.replace(\"{{internationalScheduledPaymentInitiation}}\", pm.globals.get(\"internationalScheduledPaymentInitiation\"));",
											"",
											"// Request data must be exactly the same as what the JWS is based on",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"internationalScheduledPaymentId\", jsonData.Data.InternationalScheduledPaymentId);\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{authorizedBearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n    \t\"ConsentId\": \"{{consentId}}\",\n        \"Initiation\": {{internationalScheduledPaymentInitiation}}\n    },\n    \"Risk\": {}\n}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-scheduled-payments",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-scheduled-payments"
									]
								},
								"description": "# Once the international-scheduled-payment-consent has been authorised by the PSU, the PISP can proceed to submit the international-scheduled-payment for processing."
							},
							"response": []
						},
						{
							"name": "(5) /international-scheduled-payments/{InternationalScheduledPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-scheduled-payments/{{internationalScheduledPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-scheduled-payments",
										"{{internationalScheduledPaymentId}}"
									]
								},
								"description": "# A PISP can retrieve the international-scheduled-payment to check its status."
							},
							"response": []
						},
						{
							"name": "(6) /international-scheduled-payments/{InternationalScheduledPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-scheduled-payments/{{internationalScheduledPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-scheduled-payments",
										"{{internationalScheduledPaymentId}}"
									]
								},
								"description": "# A PISP can delete a future payment"
							},
							"response": []
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					]
				},
				{
					"name": "international standing order",
					"item": [
						{
							"name": "(1) /international-standing-order-consents",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"consentId\", jsonData.Data.ConsentId);\r",
											"\r",
											"\r",
											"// Setting parameters for 'Get authentication URL' method, so one can be used for both payments and accounts\r",
											"pm.globals.set(\"consentType\", \"payment\");\r",
											"pm.globals.set(\"scope\", \"payments openid\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 10; // -10 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"var firstPaymentDateTime = new Date();",
											"firstPaymentDateTime.setDate(firstPaymentDateTime.getDate() + 1);",
											"pm.globals.set(\"firstPaymentIsoDateTime\", firstPaymentDateTime.toISOString())",
											"request.data = request.data.replace(\"{{firstPaymentIsoDateTime}}\", pm.globals.get(\"firstPaymentIsoDateTime\"));",
											"",
											"var sHeader = JSON.stringify(header);",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "1f0e68db-3730-45d1-a90f-8fcbea9bf880"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n    \t\"Permission\": \"Create\",\n        \"Initiation\": {\n            \"Frequency\": \"EVERY_MONTH\",\n            \"FirstPaymentDateTime\": \"{{firstPaymentIsoDateTime}}\",\n            \"CurrencyOfTransfer\": \"EUR\",\n            \"InstructedAmount\": {\n                \"Amount\": \"2.00\",\n                \"Currency\": \"EUR\"\n            },\n            \"CreditorAccount\": {\n                \"SchemeName\": \"UK.OBIE.IBAN\",\n                \"Identification\": \"FI4966010005485495\",\n                \"Name\": \"Jane Roe\"\n            }\n        }\n    },\n    \"Risk\": {}\n}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-standing-order-consents",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-standing-order-consents"
									]
								},
								"description": "# The API endpoint allows the PISP to ask an ASPSP to create a new international-standing-order-consent resource."
							},
							"response": []
						},
						{
							"name": "(2) /international-standing-order-consents/{ConsentId}",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);",
											"",
											"pm.globals.set(\"internationalStandingOrderPaymentInitiation\", JSON.stringify(jsonData.Data.Initiation));"
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "18730fec-304b-4d3a-a64a-aeeb08f9a342"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-standing-order-consents/{{consentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-standing-order-consents",
										"{{consentId}}"
									]
								},
								"description": "# A PISP can optionally retrieve a payment consent resource that they have created to check its status."
							},
							"response": []
						},
						{
							"name": "(4) /international-standing-orders",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"var navigator = {};",
											"var window = {};",
											"eval(pm.globals.get(\"jsrsasign-js\"));",
											"",
											"var header = {\"b64\":false,\"http:\\/\\/openbanking.org.uk\\/iat\":0,\"http:\\/\\/openbanking.org.uk\\/tan\":\"\",\"crit\":[\"b64\",\"http:\\/\\/openbanking.org.uk\\/iat\",\"http:\\/\\/openbanking.org.uk\\/tan\",\"http:\\/\\/openbanking.org.uk\\/iss\"],\"kid\":\"\",\"http:\\/\\/openbanking.org.uk\\/iss\":\"\",\"alg\":\"PS256\"};",
											"",
											"",
											"var unixTimestamp = Math.round((new Date()).getTime() / 1000) - 10; // -10 since it is sometimes rounds up to future..",
											"header['http://openbanking.org.uk/tan'] = pm.variables.get(\"x-fapi-financial-id\") + \"-api-sandbox.crosskey.io\";",
											"header['http://openbanking.org.uk/iat'] = unixTimestamp;",
											"header['http://openbanking.org.uk/iss'] = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
											"header['kid'] = pm.variables.get(\"digitalSignatureCertificateSerialNumber\");",
											"",
											"var sHeader = JSON.stringify(header);",
											"",
											"request.data = request.data.replace(\"{{consentId}}\", pm.globals.get(\"consentId\"));",
											"request.data = request.data.replace(\"{{internationalStandingOrderPaymentInitiation}}\", pm.globals.get(\"internationalStandingOrderPaymentInitiation\"));",
											"// Request data must be exactly the same as what the JWS is based on",
											"var sJWS = KJUR.jws.JWS.sign(header.alg, sHeader, request.data, pm.variables.get(\"digitalSignaturePrivateKey\"));",
											"",
											"// Both header and signature should be sent, but not body.",
											"var splitJWS = sJWS.split(\".\");",
											"var JWSWithoutPayload = splitJWS[0] + \"..\" + splitJWS[splitJWS.length - 1];",
											"",
											"pm.globals.set(\"JWSSignature\", JWSWithoutPayload);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = JSON.parse(responseBody);\r",
											"\r",
											"pm.globals.set(\"internationalStandingOrderPaymentId\", jsonData.Data.InternationalStandingOrderId);\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{authorizedBearerToken}}"
									},
									{
										"description": "Needs to be created and signed based on body",
										"key": "x-jws-signature",
										"type": "text",
										"value": "{{JWSSignature}}"
									},
									{
										"description": "For each new payment, a unique id must be provided. (Unique for the last 24 hours)",
										"key": "x-idempotency-key",
										"type": "text",
										"value": "{{randomUUID}}"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"Data\": {\n    \t\"ConsentId\": \"{{consentId}}\",\n        \"Initiation\": {{internationalStandingOrderPaymentInitiation}}\n    },\n    \"Risk\": {}\n}"
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-standing-orders",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-standing-orders"
									]
								},
								"description": "# Once the international-standing-order-consent has been authorised by the PSU, the PISP can proceed to submit the international-standing-orders for processing."
							},
							"response": []
						},
						{
							"name": "(5) /international-standing-orders/{InternationalStandingOrderPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-standing-orders/{{internationalStandingOrderPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-standing-orders",
										"{{internationalStandingOrderPaymentId}}"
									]
								},
								"description": "# A PISP can retrieve the international-standing-orders to check its status."
							},
							"response": []
						},
						{
							"name": "(6) /international-standing-orders/{InternationalStandingOrderPaymentId}",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [
									{
										"key": "Accept",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/json"
									},
									{
										"key": "x-fapi-customer-last-logged-time",
										"type": "text",
										"value": "Sun, 10 Sep 2017 19:43:31 UTC"
									},
									{
										"key": "x-fapi-customer-ip-address",
										"type": "text",
										"value": "127.0.0.1"
									},
									{
										"description": "Generate new for each request for tracability",
										"key": "x-fapi-interaction-id",
										"type": "text",
										"value": "842f50ff-c734-42c3-a721-13164eed7bda"
									},
									{
										"key": "x-api-key",
										"type": "text",
										"value": "{{x-api-key}}"
									},
									{
										"description": "Needs to be inserted",
										"key": "Authorization",
										"type": "text",
										"value": "Bearer {{bearerToken}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v3.1.6/pisp/international-standing-orders/{{internationalStandingOrderPaymentId}}",
									"protocol": "https",
									"host": [
										"{{x-fapi-financial-id}}-api-sandbox",
										"crosskey",
										"io"
									],
									"path": [
										"open-banking",
										"v3.1.6",
										"pisp",
										"international-standing-orders",
										"{{internationalStandingOrderPaymentId}}"
									]
								},
								"description": "# A PISP can delete a future payment"
							},
							"response": []
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					]
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "AUTH",
			"item": [
				{
					"name": "(1) /token?grant_type=client_credentials",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"",
									"pm.globals.set(\"bearerToken\", jsonData.access_token);",
									"var navigator = {};",
									"var window = {};",
									"eval(pm.globals.get(\"jsrsasign-js\"));",
									"var signingCertificate = new X509();",
									"signingCertificate.readCertPEM(pm.variables.get(\"digitalSignatureCertificate\"));",
									"// We have to remove the starting / character, as the KJUR library uses it, while api verification code does not expect it",
									"var subjectDN = KJUR.asn1.x509.X500Name.onelineToLDAP(signingCertificate.getSubjectString()).replace(',', ', ');",
									"pm.globals.set(\"digitalSignatureCertificateSubjectDN\", subjectDN);"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded; charset=UTF-8",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v2.0/oidc/token?client_id={{clientId}}&grant_type=client_credentials&scope=accounts payments openid",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v2.0",
								"oidc",
								"token"
							],
							"query": [
								{
									"key": "client_id",
									"value": "{{clientId}}"
								},
								{
									"key": "grant_type",
									"value": "client_credentials"
								},
								{
									"key": "scope",
									"value": "accounts payments openid"
								}
							]
						},
						"description": "# Obtain consent access token\n\nAuthorize your client with correct scope using OAuth2 client credentials grant and mutual TLS"
					},
					"response": []
				},
				{
					"name": "(2) End-user authorization - READ MY DESCRIPTION",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"var navigator = {};",
									"var window = {};",
									"eval(pm.globals.get(\"jsrsasign-js\"));",
									"",
									"var header = {",
									"    \"alg\":\"PS256\"",
									"};",
									"",
									"var data = {\"scope\":\"\",\"claims\":{\"id_token\":{\"openbanking_intent_id\":{\"value\":\"urn:TENANT:CONSENT_TYPE:CONSENT_ID\",\"essential\":true}}},\"iss\":\"\",\"redirect_uri\":\"\",\"state\":\"ipLYgl3BqlG3F0-FAqFNEytP-ksBv1shpbfEFlU8LVE\",\"nonce\":\"23389ac0-8f46-4a8a-a022-4d1f5eecef63\",\"client_id\":\"\"};",
									"",
									"",
									"data.scope = pm.variables.get(\"scope\");",
									"data.client_id = pm.variables.get(\"clientId\");",
									"data.iss = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"CONSENT_ID\", pm.globals.get(\"consentId\"));",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"CONSENT_TYPE\", pm.globals.get(\"consentType\"));",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"TENANT\", pm.variables.get(\"x-fapi-financial-id\"));",
									"",
									"data.redirect_uri = pm.variables.get(\"callbackUrl\");",
									"",
									"var sHeader = JSON.stringify(header);",
									"var sPayload = JSON.stringify(data);",
									"",
									"var sJWT = KJUR.jws.JWS.sign(header.alg, sHeader, sPayload, pm.variables.get(\"digitalSignaturePrivateKey\"));",
									"",
									"let financialId = pm.variables.get(\"x-fapi-financial-id\");",
									"let scope = \"accounts+openid\";",
									"let responseType = \"code+id_token\";",
									"let redirectUri = pm.variables.get(\"callbackUrl\");",
									"let state = \"ipLYgl3BqlG3F0-FAqFNEytP-ksBv1shpbfEFlU8LVE\";",
									"let nonce = \"23389ac0-8f46-4a8a-a022-4d1f5eecef63\";",
									"let clientId = pm.variables.get(\"clientId\");",
									"",
									"var url = `https://${financialId}-sandbox.crosskey.io/open-banking/v2.0/oidc/auth?request=${sJWT}&scope=${scope}&response_type=${responseType}&redirect_uri=${redirectUri}&state=${state}&nonce=${nonce}&client_id=${clientId}`",
									"",
									"console.log(\"Url to open in browser:\");",
									"console.log(url);",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/x-www-form-urlencoded; charset=UTF-8"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "/",
							"path": [
								""
							]
						},
						"description": "# End-user authorization\n\nThis is not yet implemented into the collection, so we've instead provided a workaround which requires some interactions between postman and your browser.\n\n## The Workaround\nThis request generates an URL for you to copy into your browser, where you can perform end-user authorization. When done, you're redirected back to your callback URL were you'll need to extract the value from the fragment part **code**. Save it as you'll need it for next request, where it's provided as a query param.\n\n## Steps:\n1. Send GET request.\n2. Open postman console.\n3. Copy URL from console into your browser.\n4. Perform end user authorization.\n5. Redirected back to your callback.\n6. Copy value from the callback URL fragment part **code**.\n\n\nThat's it! Provide the copied value as query param in the next step."
					},
					"response": []
				},
				{
					"name": "(3) /token?grant_type=authorization_code",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"var navigator = {};",
									"var window = {};",
									"eval(pm.globals.get(\"jsrsasign-js\"));",
									"",
									"var header = {",
									"    \"alg\":\"RS256\"",
									"};",
									"",
									"var data = {\"scope\":\"\",\"claims\":{\"id_token\":{\"openbanking_intent_id\":{\"value\":\"urn:TENANT:CONSENT_TYPE:CONSENT_ID\",\"essential\":true}}},\"iss\":\"\",\"redirect_uri\":\"\",\"state\":\"ipLYgl3BqlG3F0-FAqFNEytP-ksBv1shpbfEFlU8LVE\",\"nonce\":\"23389ac0-8f46-4a8a-a022-4d1f5eecef63\",\"client_id\":\"\"};",
									"",
									"",
									"data.scope = pm.variables.get(\"scope\");",
									"data.client_id = pm.variables.get(\"clientId\");",
									"data.iss = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"CONSENT_ID\", pm.globals.get(\"consentId\"));",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"CONSENT_TYPE\", pm.globals.get(\"consentType\"));",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"TENANT\", pm.variables.get(\"x-fapi-financial-id\"));",
									"data.redirect_uri = pm.variables.get(\"callbackUrl\");",
									"",
									"var sHeader = JSON.stringify(header);",
									"var sPayload = JSON.stringify(data);",
									"",
									"var sJWT = KJUR.jws.JWS.sign(header.alg, sHeader, sPayload, pm.variables.get(\"digitalSignaturePrivateKey\"));"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"",
									"pm.globals.set(\"authorizedBearerToken\", jsonData.access_token);",
									"pm.globals.set(\"authorizedRefreshToken\", jsonData.refresh_token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/x-www-form-urlencoded; charset=UTF-8"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v2.0/oidc/token?code=&grant_type=authorization_code&redirect_uri={{callbackUrl}}&client_id={{clientId}}",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v2.0",
								"oidc",
								"token"
							],
							"query": [
								{
									"key": "code",
									"value": ""
								},
								{
									"key": "grant_type",
									"value": "authorization_code"
								},
								{
									"key": "redirect_uri",
									"value": "{{callbackUrl}}"
								},
								{
									"key": "client_id",
									"value": "{{clientId}}"
								}
							]
						},
						"description": "# Exchange authorization code for access token\n\nExchange your authorization code obtained from **Hybrid Flow Request** for an access token using OAuth2 authorization code grant and mutual TLS"
					},
					"response": []
				},
				{
					"name": "(4) /token?grant_type=refresh_token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"",
									"pm.globals.set(\"authorizedBearerToken\", jsonData.access_token);",
									"pm.globals.set(\"authorizedRefreshToken\", jsonData.refresh_token);"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"var navigator = {};",
									"var window = {};",
									"eval(pm.globals.get(\"jsrsasign-js\"));",
									"",
									"var header = {",
									"    \"alg\":\"RS256\"",
									"};",
									"",
									"var data = {\"scope\":\"\",\"claims\":{\"id_token\":{\"openbanking_intent_id\":{\"value\":\"urn:TENANT:CONSENT_TYPE:CONSENT_ID\",\"essential\":true}}},\"iss\":\"\",\"redirect_uri\":\"\",\"state\":\"ipLYgl3BqlG3F0-FAqFNEytP-ksBv1shpbfEFlU8LVE\",\"nonce\":\"23389ac0-8f46-4a8a-a022-4d1f5eecef63\",\"client_id\":\"\"};",
									"",
									"",
									"data.scope = pm.variables.get(\"scope\");",
									"data.client_id = pm.variables.get(\"clientId\");",
									"data.iss = pm.variables.get(\"digitalSignatureCertificateSubjectDN\");",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"CONSENT_ID\", pm.globals.get(\"consentId\"));",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"CONSENT_TYPE\", pm.globals.get(\"consentType\"));",
									"data.claims.id_token.openbanking_intent_id.value = data.claims.id_token.openbanking_intent_id.value.replace(\"TENANT\", pm.variables.get(\"x-fapi-financial-id\"));",
									"data.redirect_uri = pm.variables.get(\"callbackUrl\");",
									"",
									"var sHeader = JSON.stringify(header);",
									"var sPayload = JSON.stringify(data);",
									"",
									"var sJWT = KJUR.jws.JWS.sign(header.alg, sHeader, sPayload, pm.variables.get(\"digitalSignaturePrivateKey\"));",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/x-www-form-urlencoded; charset=UTF-8"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "https://{{x-fapi-financial-id}}-api-sandbox.crosskey.io/open-banking/v2.0/oidc/token?refresh_token={{authorizedRefreshToken}}&grant_type=refresh_token&client_id={{clientId}}",
							"protocol": "https",
							"host": [
								"{{x-fapi-financial-id}}-api-sandbox",
								"crosskey",
								"io"
							],
							"path": [
								"open-banking",
								"v2.0",
								"oidc",
								"token"
							],
							"query": [
								{
									"key": "refresh_token",
									"value": "{{authorizedRefreshToken}}"
								},
								{
									"key": "grant_type",
									"value": "refresh_token"
								},
								{
									"key": "client_id",
									"value": "{{clientId}}"
								}
							]
						},
						"description": "# Refresh account access token\n\nNote: This will only work for account api's since you do not get a refresh token for payments."
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"function uuidv4() {",
					"  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {",
					"    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);",
					"    return v.toString(16);",
					"  });",
					"}",
					"",
					"pm.globals.set(\"randomUUID\", uuidv4());",
					"pm.globals.set(\"dateNow\", new Date());",
					"",
					"var min=100; ",
					"var max=9999999999999;  ",
					"var random =Math.floor(Math.random() * (+max - +min)) + +min;",
					"pm.globals.set(\"randomNumber\", random);"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "x-api-key",
			"value": ""
		},
		{
			"key": "x-fapi-financial-id",
			"value": ""
		},
		{
			"key": "clientId",
			"value": ""
		},
		{
			"key": "callbackUrl",
			"value": ""
		},
		{
			"key": "digitalSignaturePrivateKey",
			"value": ""
		},
		{
			"key": "digitalSignatureCertificateSerialNumber",
			"value": ""
		},
		{
			"key": "digitalSignatureCertificate",
			"value": ""
		}
	]
}